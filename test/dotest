#!/bin/bash
# Tests for Nancy
# FIXME: add failure message

set -e

# One-tree test
rm -rf dest
NANCY_CMD="../nancy --verbose --root src template.html"
#NANCY_CMD="perl -wMDevel::SimpleTrace ../nancy --verbose --root src template.html"
mkdir dest
mkdir dest/people
for page in index.html people/index.html people/adam.html people/eve.html; do
    $NANCY_CMD $page > dest/$page
done
diff -Nur expected dest

# FIXME: Resurrect with mergetrees.pl
# # Two-tree test
# rm -rf dest2
# ../nancy --root src2 template.html index.html
# diff -Nur dest2 expected2
